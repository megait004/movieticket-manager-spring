<div th:replace="~{layouts/main :: layout(~{::title}, ~{::section})}">
  <title>Đăng kí</title>
  <section class="flex flex-grow items-center justify-center py-12">
    <div class="w-full max-w-md">
      <div class="rounded-lg bg-white p-8 shadow-md">
        <div class="mb-8 text-center">
          <i class="fa fa-user-circle mb-4 text-5xl! text-blue-600"></i>
          <h1 class="text-2xl font-bold text-gray-800">Đăng kí</h1>
          <p class="mt-2 text-gray-600">Đăng kí tài khoản mới</p>
        </div>

        <div id="register-error-container">
          <div
            id="register-error"
            class="mb-4 hidden rounded border border-red-400 bg-red-100 px-4 py-3 text-red-700"
            role="alert"
          >
            <span id="error-message">Lỗi đăng kí</span>
          </div>
        </div>

        <form
          hx-post="/api/register"
          hx-ext="json-enc"
          hx-trigger="submit"
          hx-indicator="#register-indicator"
          hx-target="#register-error-container"
          hx-swap="innerHTML"
          class="space-y-6"
        >
          <div>
            <label
              for="email"
              class="mb-1 block text-sm font-medium text-gray-700"
              >Email</label
            >
            <div class="relative">
              <div
                class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"
              >
                <i class="fa fa-envelope text-gray-400"></i>
              </div>
              <input
                type="text"
                id="email"
                name="email"
                class="block w-full rounded-md border border-gray-300 py-2 pr-3 pl-10 shadow-sm focus:border-blue-500 focus:ring-blue-500"
                placeholder="Email"
                required
                oninvalid="this.setCustomValidity('Vui lòng nhập địa chỉ email')"
                oninput="this.setCustomValidity('')"
              />
            </div>
          </div>
          <div>
            <label
              for="username"
              class="mb-1 block text-sm font-medium text-gray-700"
              >Tên đăng nhập</label
            >
            <div class="relative">
              <div
                class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"
              >
                <i class="fa fa-user text-gray-400"></i>
              </div>
              <input
                type="text"
                id="username"
                name="username"
                class="block w-full rounded-md border border-gray-300 py-2 pr-3 pl-10 shadow-sm focus:border-blue-500 focus:ring-blue-500"
                placeholder="Tên đăng nhập"
                required
                oninvalid="this.setCustomValidity('Vui lòng nhập tên đăng nhập')"
                oninput="this.setCustomValidity('')"
              />
            </div>
          </div>

          <div>
            <label
              for="password"
              class="mb-1 block text-sm font-medium text-gray-700"
              >Mật khẩu</label
            >
            <div class="relative">
              <div
                class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"
              >
                <i class="fa fa-lock text-gray-400"></i>
              </div>
              <input
                type="password"
                id="password"
                name="password"
                class="block w-full rounded-md border border-gray-300 py-2 pr-10 pl-10 shadow-sm focus:border-blue-500 focus:ring-blue-500"
                placeholder="••••••••"
                required
                oninvalid="this.setCustomValidity('Vui lòng nhập mật khẩu')"
                oninput="this.setCustomValidity('')"
              />
              <button
                type="button"
                onclick="togglePassword()"
                class="absolute inset-y-0 right-0 flex cursor-pointer items-center pr-3"
              >
                <i
                  id="password-toggle"
                  class="fa fa-eye text-gray-400 hover:text-gray-600"
                ></i>
              </button>
            </div>
          </div>

          <div>
            <button
              type="submit"
              class="flex w-full cursor-pointer justify-center rounded-md border border-transparent bg-blue-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:outline-none"
            >
              <span>Đăng kí</span>
              <span id="register-indicator" class="htmx-indicator ml-2">
                <i class="fa fa-spinner fa-spin"></i>
              </span>
            </button>
          </div>
        </form>

        <script>
          function togglePassword() {
            const passwordInput = document.getElementById("password");
            const passwordToggle = document.getElementById("password-toggle");

            if (passwordInput.type === "password") {
              passwordInput.type = "text";
              passwordToggle.classList.remove("fa-eye");
              passwordToggle.classList.add("fa-eye-slash");
            } else {
              passwordInput.type = "password";
              passwordToggle.classList.remove("fa-eye-slash");
              passwordToggle.classList.add("fa-eye");
            }
          }
        </script>

        <div class="mt-6 text-center">
          <p class="text-sm text-gray-600">
            Đã có tài khoản?
            <a
              href="/login"
              hx-get="/login"
              hx-target="main"
              hx-push-url="true"
              class="font-medium text-blue-600 hover:text-blue-500"
            >
              Đăng Nhập ngay
            </a>
          </p>
        </div>
      </div>
    </div>
  </section>
</div>
